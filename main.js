(()=>{const e=document.querySelector("#flip-button"),t=document.querySelector(".option-container"),n=document.querySelector("#gamesboard-container"),o=document.querySelector("#start-button"),r=document.querySelector("#info");document.querySelector("turn-display");let c=0;e.addEventListener("click",(function(){const e=Array.from(t.children);c=0===c?90:0,e.forEach((e=>e.style.transform=`rotate(${c}deg)`))}));const a=10;function s(e,t){const o=document.createElement("div");o.classList.add("game-board"),o.style.backgroundColor=e,o.id=t;for(let e=0;e<a*a;e++){const t=document.createElement("div");t.classList.add("block"),t.id=e,o.append(t)}n.append(o)}s("yellow","player"),s("pink","computer");class l{constructor(e,t){this.name=e,this.length=t}}const i=[new l("destroyer",2),new l("submarine",3),new l("cruiser",3),new l("battleship",4),new l("carrier",5)];let d,u;function h(e,t,n,o){let r,c=t?n<=a*a-o.length?n:a*a-o.length:n<=a*a-a*o.length?n:n-o.length*a+a,s=[];for(let n=0;n<o.length;n++)t?s.push(e[Number(c)+n]):s.push(e[Number(c)+n*a]);t?s.every(((e,t)=>r=s[0].id%a!=a-(s.length-(t+1)))):s.every(((e,t)=>r=s[0].id<a*t+1+90));const l=s.every((e=>!e.classList.contains("taken")));return{shipBlocks:s,valid:r,notTaken:l}}function m(e,t,n){const o=document.querySelectorAll(`#${e} div`);let r=Math.random()<.5,s="player"===e?0===c:r,l=Math.floor(Math.random()*a*a),i=n||l;const{shipBlocks:u,valid:p,notTaken:f}=h(o,s,i,t);p&&f?u.forEach((e=>{e.classList.add(t.name),e.classList.add("taken")})):("computer"===e&&m(e,t,n),"player"===e&&(d=!0))}function p(e){d=!1,u=e.target}function f(e){e.preventDefault();const t=i[u.id];!function(e,t){const n=document.querySelectorAll("#player div");let o=0===c;const{shipBlocks:r,valid:a,notTaken:s}=h(n,o,e,t);a&&s&&r.forEach((e=>{e.classList.add("hover"),setTimeout((()=>e.classList.remove("hover")),500)}))}(e.target.id,t)}function y(e){const t=e.target.id;m("player",i[u.id],t),d||u.remove()}i.forEach((e=>m("computer",e))),Array.from(t.children).forEach((e=>e.addEventListener("dragstart",p))),document.querySelectorAll("#player div").forEach((e=>{e.addEventListener("dragover",f),e.addEventListener("drop",y)}));function v(e){e.target.classList.contains("taken")&&(e.target.classList.add("boom"),r.textContent="You hit the computer's ship!")}o.addEventListener("click",(function(){0!=t.children.length?r.textContent="Please place all your ships first!":document.querySelectorAll("#computer div").forEach((e=>e.addEventListener("click",v)))}))})();